{% extends "base.html" %}
{% block content %}
<h2>
    比數：{{ team_score }} ：{{ opponent_score }}<br>
    <span style="font-size:1.2em;">我方 vs {{ opponent }}</span>
</h2>
<hr>
<h2>第 {{ inning }} 局{{ '上' if is_top else '下' }}｜出局數：{{ outs }}</h2>
<h3>第 {{ order + 1 }} 棒 - {{ batter.name }}</h3>
<form method="post">
    <label>打擊結果：</label>
    <select name="result" required>
        {% for r in result_types %}
        <option value="{{ r }}">{{ r }}</option>
        {% endfor %}
    </select>
    <br><br>
    <label>打點 (RBI)：</label>
    <input type="number" name="rbis" min="0" value="0">
    <br><br>
    <button type="submit">確定送出</button>
</form>
<br>
<a href="{{ url_for('switch_player', game_id=game_id) }}?order={{ order }}">球員換人</a>
<br>
<a href="{{ url_for('undo_atbat', game_id=game_id, order=order, inning=inning) }}">復原上一筆</a>
<br>
<a href="{{ url_for('index') }}">返回首頁</a>

{% if outs >= 3 %}
    <p style="color:blue;font-weight:bold;">三出局，自動切換介面。</p>
    <script>
    setTimeout(function(){
        {% if is_top %}
            window.location = "{{ url_for('record_defense', game_id=game_id, inning=inning, is_top=False) }}";
        {% else %}
            window.location = "{{ url_for('record_defense', game_id=game_id, inning=inning+1, is_top=True) }}";
        {% endif %}
    }, 1200)
    </script>
{% endif %}

<form action="{{ url_for('finish_record', game_id=game_id) }}" method="post">
    <button type="submit" style="background:#28a745;color:white;font-size:16px;">完成紀錄</button>
</form>
{% endblock %}


